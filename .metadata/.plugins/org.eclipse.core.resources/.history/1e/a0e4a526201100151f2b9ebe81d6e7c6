package Principal;

import groovy.lang.Newify;

import java.awt.BorderLayout;
import java.awt.EventQueue;
import java.awt.Toolkit;

import javax.lang.model.element.NestingKind;
import javax.swing.JDesktopPane;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.border.EmptyBorder;

import java.awt.Color;

import javax.swing.JButton;

import Conexion.Conectar;
import Imagenes.Imagenes;
import InSesion.InSesion;
import InSesion.Iniciar;
import Inventario.Inventario;
import Notas.CrearNota;
import Productos.CategoriaProductos;
import Productos.Productos;
import ProductosAgotados.ProductosAgotados;
import Promociones.Promociones;
import Reportes.Reportes;
import Usuarios.CambiarContrasena;
import Usuarios.Usuarios;
import Ventas.ConsultaPrecios;
import Ventas.Ventas;

import javax.swing.JLabel;

import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;
import net.sf.jasperreports.engine.util.JRLoader;
import net.sf.jasperreports.view.JasperViewer;

import java.awt.Font;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import java.sql.SQLException;
import java.util.Calendar;
import java.util.GregorianCalendar;
import java.awt.Frame;
//todo para llevar
public class MenuPrincipal extends JFrame {
	JLabel lblHora;
	RelojFecha relojFecha = new RelojFecha();
	public static JDesktopPane contentPane;
	ProductosAgotados agotados = new ProductosAgotados();
	Conectar conex = new Conectar();
	java.sql.Connection con;
	/**
	 * Launch the application.
	 */
	public static void main(String[] args) {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					MenuPrincipal frame = new MenuPrincipal();
					frame.setVisible(true);
					//frame.setBounds(0, 0, 1024, 768);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}

	/**
	 * Create the frame.
	 * @throws SQLException 
	 */
	
	public MenuPrincipal() throws SQLException {
		setIconImage(Toolkit.getDefaultToolkit().getImage(InSesion.class.getResource("/Imagenes/icono.png")));
		setTitle("--- Deposito - Todo Para Llevar ---");
		setBackground(new Color(211, 211, 211));
		this.setUndecorated(true);
		setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);

		//setBounds(0, 0,  1254, 768);
		contentPane = new JDesktopPane();
		contentPane.setBackground(new Color(211, 211, 211));
		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
		//contentPane.setBounds(0, 0, 1024, 768);
		setContentPane(contentPane);
		contentPane.setLayout(null);
		
		
		
		Imagenes ob2= new Imagenes();
		contentPane.setLayout(null);
		JButton btnProductos = new JButton("",ob2.MenuProductos());
		btnProductos.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				Productos n = new Productos();
				contentPane.add(n);
				n.toFront();
				n.setLocation(200, 100);
				n.setVisible(true);
			}
		});
		btnProductos.setBounds(10, 88, 137, 61);
		contentPane.add(btnProductos);
		
		Imagenes ob3 = new Imagenes ();
		JButton btnPromociones = new JButton("",ob3.MenuPromociones());
		btnPromociones.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				ConsultaPrecios n= new ConsultaPrecios();
				MenuPrincipal.contentPane.add(n);
				n.toFront();
				n.setLocation(550, 100);
				n.setVisible(true);
			}
		});
		btnPromociones.setBounds(10, 160, 137, 61);
		contentPane.add(btnPromociones);
		
		Imagenes ob4 = new Imagenes();
		JButton btnVentas = new JButton("",ob4.MenuVentas());
		btnVentas.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				Ventas ventas = new Ventas();
				contentPane.add(ventas);
				ventas.toFront();
				ventas.setLocation(180, 40);
				ventas.setVisible(true);
			}
		});
		btnVentas.setBounds(10, 232, 137, 61);
		contentPane.add(btnVentas);
		
		Imagenes ob5 = new Imagenes();
		JButton btnInventario = new JButton("",ob5.MenuInventario());
		btnInventario.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				Inventario inventario = new Inventario();
				contentPane.add(inventario);
				inventario.toFront();
				inventario.setLocation(200, 80);
				inventario.setVisible(true);
			}
		});
		btnInventario.setBounds(10, 307, 137, 61);
		contentPane.add(btnInventario);
		
		Imagenes ob6 = new Imagenes ();
		JButton btnReportes = new JButton("",ob6.MenuReportes());
		btnReportes.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				Reportes reportes = new Reportes();
				contentPane.add(reportes);
				reportes.toFront();
				reportes.setLocation(200, 80);
				reportes.setVisible(true);
			}
		});
		btnReportes.setBounds(10, 381, 137, 61);
		contentPane.add(btnReportes);
		
		Imagenes ob7 = new Imagenes ();
		JButton btnUsuarios = new JButton("",ob7.MenuUsuarios());
		btnUsuarios.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {
				Usuarios usuarios = new Usuarios();
				contentPane.add(usuarios);
				usuarios.toFront();
				usuarios.setLocation(200, 80);
				usuarios.setVisible(true);
			}
		});
		btnUsuarios.setBounds(10, 456, 137, 61);
		contentPane.add(btnUsuarios);
		
		JLabel lblUstedEstaEn = new JLabel("Usted esta en el sistema como : ");
		lblUstedEstaEn.setForeground(new Color(255, 0, 0));
		lblUstedEstaEn.setFont(new Font("Tahoma", Font.BOLD, 15));
		lblUstedEstaEn.setBounds(10, 623, 237, 27);
		contentPane.add(lblUstedEstaEn);
		
		Imagenes ob8 = new Imagenes ();
		JButton btnCambiarContrasena = new JButton("",ob8.MenuCambiarPass());
		btnCambiarContrasena.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				CambiarContrasena contrasena = new CambiarContrasena();
				contentPane.add(contrasena);
				contrasena.toFront();
				contrasena.setLocation(400, 100);
				contrasena.setVisible(true);
			}
		});
		btnCambiarContrasena.setBounds(848, 560, 137, 61);
		contentPane.add(btnCambiarContrasena);
		
		Imagenes ob9 = new Imagenes();
		JButton btnSalirSistema = new JButton("",ob9.MenuSalir());
		btnSalirSistema.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				int x=Ventas.modelo1.getRowCount();
				//JOptionPane.showMessageDialog(null, x);
				if(x==0){
					MenuPrincipal.this.dispose();
					Principal n=new Principal();
					int conta=Iniciar.conta=1;
					n.llamar();
				}else{
					JOptionPane.showMessageDialog(null, "Cancele o Termine la venta");
				}
			}
		});
		btnSalirSistema.setBounds(848, 632, 137, 61);
		contentPane.add(btnSalirSistema);
		
		Imagenes ob11 = new Imagenes();
		JLabel lblNewLabel = new JLabel(ob11.Fondo());
		lblNewLabel.setBackground(new Color(255, 0, 0));
		lblNewLabel.setBounds(188, 131, 797, 311);
		contentPane.add(lblNewLabel);
		
		JLabel lblFecha = new JLabel("");
		lblFecha.setFont(new Font("Tahoma", Font.PLAIN, 39));
		lblFecha.setForeground(new Color(255, 0, 0));
		lblFecha.setBounds(249, 482, 488, 43);
		contentPane.add(lblFecha);
		relojFecha.fecha(lblFecha);
		lblHora = new JLabel("");
		lblHora.setFont(new Font("Tahoma", Font.PLAIN, 43));
		lblHora.setForeground(new Color(255, 0, 0));
		lblHora.setBounds(720, 482, 249, 43);
		contentPane.add(lblHora);
		
		JLabel lblUsuario = new JLabel(Iniciar.loger);
		lblUsuario.setForeground(Color.BLACK);
		lblUsuario.setFont(new Font("Tahoma", Font.BOLD, 15));
		lblUsuario.setBounds(249, 623, 237, 27);
		contentPane.add(lblUsuario);
		relojFecha.reloj(lblHora);
		
		JButton btnBackup = new JButton("Backup", null);
		btnBackup.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {
				BackUp backUp = new BackUp();
				contentPane.add(backUp);
				backUp.toFront();
				backUp.setLocation(400, 100);
				backUp.setVisible(true);
			}
		});
		btnBackup.setBounds(10, 528, 137, 61);
		contentPane.add(btnBackup);
		
		JButton btnCrearNota = new JButton("Crear Nota", null);
		btnCrearNota.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {
				CrearNota nota = new CrearNota();
				contentPane.add(nota);
				nota.toFront();
				nota.setLocation(500, 100);
				nota.setVisible(true);
			}
		});
		btnCrearNota.setBounds(859, 11, 137, 61);
		contentPane.add(btnCrearNota);
		
		
		agotados.calcular();
		if (agotados.contador() > 0) {
			JLabel lblTieneProductosPor = new JLabel("Hay " + agotados.contador() + " productos por agotarse");
			lblTieneProductosPor.setForeground(Color.BLUE);
			lblTieneProductosPor.setFont(new Font("Tahoma", Font.BOLD, 11));
			lblTieneProductosPor.setBounds(677, 11, 185, 14);
			contentPane.add(lblTieneProductosPor);
			
			JButton btnGenerarReporte = new JButton("Generar Reporte");
			btnGenerarReporte.addActionListener(new ActionListener() {
				public void actionPerformed(ActionEvent arg0) {
					JTextField hola = null;
					con = conex.conexion(hola);
					try {
						String ubicacion = System.getProperty("user.dir")+"/src/Reporte/ProductosAgotados.jasper";
						JasperReport jasperReport = (JasperReport) JRLoader.loadObjectFromFile(ubicacion);
						JasperPrint print = JasperFillManager.fillReport(jasperReport, null, con);
						JasperViewer viewer = new JasperViewer(print,false);
						viewer.setVisible(true);
					} catch (Exception ex) {
						// TODO: handle exception
						JOptionPane.showMessageDialog(null, "Error  " + ex.getMessage());
					}
				}
			});
			btnGenerarReporte.setBounds(677, 30, 137, 23);
			contentPane.add(btnGenerarReporte);
		}
		
		
		//agotados.calcular();
	}
}
