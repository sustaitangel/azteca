package Conexion;

import java.io.BufferedReader;
import java.io.FileReader;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

import javax.swing.JOptionPane;
import javax.swing.JTextField;

import Productos.tipoCategoria;
import Usuarios.TipoUsuario;

public class Conectar {
	Connection conect = null;
	   public Connection conexion(JTextField hola)
	    {
		   String Cadena;
		   String servidor="";
		   String User="";
		   String pass="";
		   int bandera=0;
		   try{
			   BufferedReader bf=new BufferedReader(new FileReader("C:\\azteca\\ConfigDtb.config"));
			   String lector;
			   while((lector=bf.readLine())!=null){
				   if(bandera==0){
					   servidor=lector;
				   }
				   if(bandera==1){
					   User=lector;
				   }
				   if(bandera==2){
					   pass=lector;
				   }
				   bandera=bandera+1;
			   }
			   Cadena=servidor+User+pass;
			   System.out.println(Cadena);
			   
		   }catch(Exception e){
			   
		   }
	      try {  
	           //Cargamos el Driver MySQL
	           Class.forName("org.gjt.mm.mysql.Driver");
	           conect = DriverManager.getConnection("jdbc:mysql://localhost/todoparallevar","root","noentrar");
	        } catch (Exception e) {
	            JOptionPane.showMessageDialog(null,"Error"+e);
	        }
	        return conect;
	    }
	    
	   public ArrayList<TipoUsuario> obtenerTipos(){
			
			ArrayList listipos = new ArrayList();
			String sentencia="select descripcion from perfil";
			try{
				Connection conexion=DriverManager.getConnection("jdbc:mysql://localhost/todoparallevar","root" ,"noentrar");
				Statement comando=conexion.createStatement();
			
				ResultSet registro = comando.executeQuery(sentencia);
				String tipo;
				while(registro.next()){
					tipo=registro.getString(1);
					TipoUsuario tipos= new TipoUsuario(tipo);
					listipos.add(tipos);
				}
				registro.close();
				comando.close();
			}catch(SQLException ex){
				JOptionPane.showMessageDialog(null, ex.getMessage());
			}
			return listipos;
		}
	   
}
